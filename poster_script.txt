豊田工業大学　課題研究１報告書
学部・学科
工学部　先端工学基礎学科
学籍番号
12056
氏名
外山洋太
題名
カテゴリ間の関連性を利用した
多層ニューラルネットワークによる文書分類

1. 背景と目的
自然言語処理の一分野である文書分類は、大量の文書処理を必要とするWWWからの情報抽出等に欠かせない。その文書分類の一つに、文書を複数のカテゴリについて分類するものがある。カテゴリとはラベルが付けられる各項目のことである。これに関する従来の手法[1]では、カテゴリ同士の関連性を手動で変化させ考慮している。また、そこで用いられている文書の数値表現であるBoWは文書内の語順を無視している。
そこで、本研究は、よりよい文書の数値表現を用いながら、カテゴリ間の関連性を機械学習によって考慮した文書分類を実現することを目的とする。

2. 関連研究
2.1. カテゴリ間の関連性を用いた文書分類
カテゴリ間の関連性を用いた文書分類を扱った研究に、隠れ状態を用いたホテルレビューのレーティング予測[1]がある。この研究では、文書内の各文に対して推定した隠れレーティングとレビュー全体のレーティングとの繋がりを変化させ、カテゴリ間の関連性を考慮した分類を行っている。
2.2. パラグラフベクトル
　文書の数値表現の一つとして、Leら[2]が提案したパラグラフベクトルがある。この研究は、それが文書分類に有用であることを実験により示している。また、パラグラフベクトルの学習手法に関する研究として、森ら[3]がある。この研究では、単語同士の位置関係を考慮した単語ベクトルの学習手法
図1. 単語及び文、文章ベクトルの学習

vLBL+vLBL(c)について、パラグラフベクトルまたは文ベクトルも同時に学習する手法を提案している。

3. 提案手法
　文書の意味を的確に表現するためにvLBL+vLBL(c)の応用手法によって生成したパラグラフベクトル及び文ベクトルを、カテゴリ間の関連性を考慮するために多層ニューラルネットワーク（NN）による分類器を用いた文書分類を行う。
まず、パラグラフベクトルに加え文ベクトルを導入したvLBL+vLBL(c)を提案し、語順と単語同士の位置関係を考慮した文書の数値表現を生成する（図1）。ここで、文ベクトル学習時の目的関数gには以下の式を用いる。


tは現在の単語の位置、ctとwtはそれぞれ文脈と単語を表すベクトル、sは位置関係を考慮した単語と文脈の類似度である。上式により、現在の単語は文脈と意味が近くなるように、文脈外の単語t'については単語の頻度分布PnについてK回サンプルし文脈と意味が遠くなるように学習を行う。また、σはシグモイド関数である。次に、多層NNへの入力をパラグラフベクトル、及び、各文ベクトルの平均ベクトルとし、出力をカテゴリ毎のラベルとして教師有り学習を行う。分類時も同様な処理を行いラベルを推定する。

4. 実験
　文書の数値表現としてパラグラフベクトルが有効かを調査するため予備実験を行った。パラグラフベクトルの学習手法としてはvLBL+vLBL(c)を、分類器としてはSVMまたは多層NNを用い、従来の手法[1]と同じ多値分類問題の精度を測定した。
4.1. 実験設定
入力データは、宿泊予約サイト楽天トラベルにおける各ホテルレビューのコメント部分とそのユーザが付けた食事、サービスなど7カテゴリのレーティングの組である。各カテゴリのレーティングは評価なしを含む6段階評価である。全レビュー338,028件の内、訓練データとして300,000件、評価データとして10,000件を用いた。

表1. 点数推定プログラムのパラメータ設定
項目
値
学習する単語の範囲
前後5単語
単語の最少出現回数
5回
ベクトルの次元数
400
中間層の数
1
入力層でのニューロン数
800個
中間層でのニューロン数
200個

表2. 各手法における点数推定精度
項目
点数推定の精度(%)
実験での手法（SVM）
33.6
実験での手法（多層NN）
37.7
従来の手法[1]
48.3
　プログラム上の主なパラメータを表1に示す。現在の単語の学習に影響する範囲をその単語の前後5単語とした。単語及びパラグラフベクトルの次元は400次元とし、多層NNの入力は位置を考慮した及び考慮していない2つのパラグラフベクトルとした。

4.2. 結果及び考察
　表2の実験結果より、多層NNを用いた方がSVMより4.1pp精度が高かった。しかし、多層NNを用いた手法でも、従来の手法[1]における精度を10pp以上下回っている。精度を高めるためには、文ベクトルとパラグラフベクトルを組み合わせより表現力の高い文書の数値表現を評価することや、多層NNのパラメータ最適化が必要である。

5. まとめと今後の課題
　本研究では、カテゴリ間の関連性を考慮した文書分類を行うためパラグラフベクトルと多層NNを用いた手法を提案した。実験結果より、さらに精度を高めるためには手法のさらなる改善が必要であることが分かった。
今後の課題は、文ベクトルの評価と多層NNのパラメータ最適化である。その後、提案手法の有用性を評価する。また、さらに精度を高めるため、文書の表現学習及び分類器に関する新たな改良策の提案を目指す。

参考文献
[1] 藤谷宣典ら, 隠れ状態を用いたホテルレビューのレーティング予測. 言語処理学会 第21回年次大会, 2015.
[2] Quoc Le et al., Distributed Representations of Sentences and Documents. ICML 2014, 2014.
[3] 森洸樹ら, 英文穴埋め問題における文章ベクトルと学習データの質の影響. 第222回自然言語処理研究会, 2015.
